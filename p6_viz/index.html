<!DOCTYPE html>

<!------------------------------------------------------------------------------
 -- File:        index.html
 -- Project:     DATAN P6
 -- Purpose:     Main page of the data viz app
 -- Author:      Ivailo Kassamakov (c) 2016
 -- Created:     15-Jul-2016  
 -- Last change: 
 -- Standard:    HTML5/CSS3
 -- Notes:       
 ------------------------------------------------------------------------------>

<html>

<head>
	<meta charset='utf-8'>
	<meta name='viewport' content='width=device-width'>

	<title>DataViz of Prosper loans (DATAN P6)</title>

	<!--Third party CSS-->
	<link href='https://fonts.googleapis.com/css?family=Old+Standard+TT' rel='stylesheet' type='text/css'>
	<link href='https://fonts.googleapis.com/css?family=Vollkorn:400,400italic' rel='stylesheet' type='text/css'>

	<!--Third party JS-->
	<script type='text/javascript' src='https://d3js.org/d3.v4.min.js'></script>
	<script src="//d3js.org/topojson.v1.min.js"></script>
	<script src='https://code.jquery.com/jquery-3.1.0.min.js'
			integrity='sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s=' 
			crossorigin='anonymous'></script>

	<!--Own JS-->
	<script type='text/javascript' src='js/drawPrimitives.js'></script>
	<script type='text/javascript' src='js/View.js'></script>
	<script type='text/javascript' src='js/page0.js'></script>
	<script type='text/javascript' src='js/page1.js'></script>
	<script type='text/javascript' src='js/page2.js'></script>
	<script type='text/javascript' src='js/story.js'></script>
	
	<!--Own CSS-->
	<link href='css/viz.css' rel='stylesheet' type='text/css'>
	<link href='css/filter.svg' rel='external' type='image/svg+xml'>

	<style>
		#div-chart {
			/* Center vert/horiz in the middle of the page */
			display: inline-block;
			top: 50%;
			left: 50%;
			position: absolute;
			transform: translate(-50%, -50%);
		}

		body {
			font-family: 'Old Standard TT', Verdana, sans-serif;
		}
		h1 {
			font-size: 40px;
			text-align: center;
			line-height: 150%;
		}

		footer {
			display: block;
			position: absolute;
			bottom: 2%;
			left: 50%;
			transform: translate(-50%, -50%);

			font-family: Vollkorn, Verdana, sans-serif;
			font-style: italic;
		}
		
	</style>

</head>

<body>
	<!--<h1>How people in the US take credits (based on statistics of Prosper Loans)</h1>-->
<svg height="0" width="0" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <filter id="f3" x="-10%" y="-10%" width="120%" height="120%">
      <feOffset result="offOut" in="SourceAlpha" dx="3" dy="3" />
      <feGaussianBlur result="blurOut" in="offOut" stdDeviation="4" />
      <feBlend in="SourceGraphic" in2="blurOut" mode="screen" />
    </filter>
  </defs>
</svg>

	<div id='div-chart'>
	</div>

	<script type='text/javascript'>
	'option strict';

	var mainCtrl = {
		storyCtrl: storyCtrl,

		viz: {
			story_margin: 10,
			story_width: 1200,
			story_height: 800,
			init: function() {
				this.width  = this.story_width + 2 * this.story_margin;
				this.height = this.story_height + 2 * this.story_margin;
				return this;
			},
			d3c: null
		}.init(),

		init: function(parent_div) {
			this.createSVG(parent_div);
			this.storyCtrl.createView(this.viz.d3c, this);
		},

		createSVG: function(parent_div) {
			this.viz.d3c  = d3.select(parent_div).
				append('svg').
				attr('class', 'viz-canvas').
				attr('width', this.viz.width).
				attr('height', this.viz.height).
				append('g').
				// Move the coordinate origin to the natural bottom left corner
				attr('transform', 'translate(' + this.viz.story_margin + 
					', ' + this.viz.story_margin + ')');
		}, // end function createCanvas(...)
		
		dataReady(error, data) {
			if (error) throw error;
			
			alert("Data was loaded OK!")
		}
	};

	d3.queue()
		.defer(d3.csv, "data/prosper_loans.csv")
		.defer(d3.csv, "data/Income data for US states.csv", function(d) { return d; })
		.await(mainCtrl.dataReady);
	//d3.csv('', mainCtrl.dataReady);
	
	mainCtrl.init('#div-chart');
	</script>

	<footer>
	&copy; Ivailo Kassamakov 2016, GPL v.3
	</footer>

</body>

</html>

<!-- EOF -->
